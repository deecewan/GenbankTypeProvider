<h1 id="existing-project">Existing Project</h1>
<p>As of the last report, there was a type provider with limited functionality. The implementation was able to download listings of taxa and genomes from the Genbank service, and provide them as types. Included was the FTP urls where the given data could be found, and a rudimentary file parser for the accession data. This acted as a proof of concept of what was to come. It enabled a basic type provider to be built and for a better scope of what was required in the future.</p>
<h1 id="updates-to-the-project">Updates to the Project</h1>
<h3 id="enhanced-logging-capabilities">Enhanced Logging Capabilities</h3>
<p>In the previous version of the project, there was a logger added. However, it often did not work, was awkward to use, and was not used widely in the application. This made it difficult to debug issues in the already notoriously difficult conditions of working with Type Providers. The following changes were complemented by far more complete instrumentation throughout the library.</p>
<h4 id="colorized-output">Colorized Output</h4>
<p>A fairly minor addition, but an immeasurably useful one when confronted by a wall of text at a command prompt. A library, <code>Colorful.Console</code>, was used in order to print coloured text to the prompt. This included colouring <code>success</code>, <code>info</code>, <code>warn</code> and <code>error</code> logs in different colours for easy identification. The other feature was providing each logger with a new colour to print its name in. This allowed for easy identification of which module was producing which output.</p>
<p>A downside to adding this functionality, however, was that the distribution mechanism for the library seemed unable to pick up, or instrument, the dependency correctly when bundling for release. The net-result of this is that including the library in any other project resulted in a compiler error due to the missing dependency and the project unable to compile. This is discussed in further detail in <a href="#nuget-distribution">NuGet Distribution</a>.</p>
<h4 id="ergonomic-api">Ergonomic API</h4>
<p>The previous API was not easy to use. The logger accepted only strings, which meant that there were a lot of log lines that looked as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode fsharp"><code class="sourceCode fsharp"><a class="sourceLine" id="cb1-1" data-line-number="1">logger.Info(sprintf(<span class="st">&quot;The result of the previous call was: %s&quot;</span>)(result))</a></code></pre></div>
<p>With the new implementation, the <code>sprintf</code> functionality has been incorporated using <code>Printf.ksprintf</code> to enable a far more user friendly API. The same call from above now looks as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode fsharp"><code class="sourceCode fsharp"><a class="sourceLine" id="cb2-1" data-line-number="1">logger.Info(<span class="st">&quot;The result of the previous call was: %s&quot;</span>) result</a></code></pre></div>
<p>This new API still allows for the same amazing functionality of F#’s type-checked <code>printf</code> statements, but reduces the verbosity of the logging statements.</p>
<h4 id="functional-file-level-log-writing">Functional file-level log writing</h4>
<p>A part of the previous logging library that never quite worked correctly was the <code>FileWriter</code> - it would cause the application to crash, or would not result in a log being created. This has been fixed to allow for the log-lines to be appended to a file, which can then be watched with <code>tail</code> as new log entries are added for a live execution summary. This makes it much easier to follow along with, as well as debug, the library when it is running in another project. Importantly, however, writing to a file causes a slowdown, as there is a non-zero cost to appending to a file, which is exacerbated by the sheer volume of logging. This could be fixed long-term by adding an in-memory buffer, and flushing it after a predetermined time. This approach would provide a ‘best of both worlds’ result, as long as the time between buffer writes was fast enough that it did not hinder a user watching the logs.</p>
<h3 id="nuget-distribution">NuGet Distribution</h3>
<p>A big part of the original intention for the project was making it easy to consume by others. The primary way of consuming third-party libraries in the .NET ecosystem is using the NuGet package repository. In order to following the conventions of the community, a NuGet package was created an published. This was initially done as a proof-of-concept to ensure that it would work when required in the future.</p>
<p>Building the package initially proved straightforward, using a <code>paket.template</code> and the <code>paket pack</code> commands.</p>
<p>The <a href="https://www.nuget.org/packages/GenbankTypeProvider/1.0.0">first version</a> was published and tested in a <a href="https://github.com/deecewan/GenbankDemoProject">very small demo project</a>. As soon as the newly published package was added to the example project, the compilation broke and complained of an error with <code>Colorful.Console</code>.</p>
